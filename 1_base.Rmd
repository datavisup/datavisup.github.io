---
title: "Séance 1: Bases de la Data Visualisation"
output:
    html_document:
      self_contained: no
      toc: true
      toc_float: true
      number_sections: false
      theme: journal
      highlight: textmate
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r eval=FALSE, echo=FALSE}
rmarkdown::render_site()

install.packages("knitr")
install.packages("rmarkdown")
install.packages("ggvis")
install.packages("googleVis")
install.packages("GGally")
install.packages("scatterplot3d")
install.packages("party")

```


# Objectif

L'objectif de cette séance est de se familiariser avec les graphiques de base. En fonction des données, et de l'objectif de la visualisation, créer un graphique à l'aide de différents packages R.

Le document final pourra vous servir de mémo pour le choix des grpahiques.

# Guide

Votre mémo pour la data visualisation pourra suivre le fil conducteur fonctionnel des graphiques : comparaison, distribution, relation et composition.

L'image ci-dessous vous donne une vision globale des différents types de graphiques qui existent en fonction des objectifs.

![](choose_graphic.jpg)

Vous pouvez également suivre d'autres fils conducteurs:

**Types de graphiques**

- Graphique d'une variable (continue ou discrète)
    - Histogramme
    - Densité
    - Combinaison d'un histogramme et d'une densité
    - Dot plot
    - Fonction de répartition
    - QQ plot
    - Bar plot des comptages
    - Camembert

- Graphique de deux variables continues
    - Nuages de points
    - Distribution bivariée

- Graphique de deux variables (l'une continue et l'autre discrète)
    - Box plot
    - Violin plot
    - Dot plot
    - Stripcharts
    - Line plot
    - Bar plot
    - Visualisation des erreurs

- Paramètres graphiques
    - Titre principal et titres des axes
    - Légende
    - Couleurs
    - Thème

**Exploration d'une série de données**

En partant d'une série de données, posez-vous les bonnes questions pour comprendre le comportement des variables, comparer les variables entre elles, comparer les différentes catégories entre elles.


# Packages

Les plus utilisés sont: ggplot2, ggvis, googleVis, plotly

D'autres moins connus : rVega, rHighcharts, clickme, gg2v, rcdimple, metricsgraphics, rCharts, rbokeh

```{r echo=FALSE}
library(data.table)
library(ggplot2)
library(plotly)
library(DT)
library(ggvis)
library(googleVis)
op <- options(gvis.plot.tag='chart')
```

# Données

Dans les packages de base, plusieurs bases de données sont incluses dans R.

```{r}
head(mtcars)
head(diamonds)
head(iris)
```

Pour comprendre le sens des variables, il suffit de regarder dans l'aide `?mtcars`.

<iframe src="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html" width="760" height="800" frameborder="0" marginheight="0" marginwidth="0">Chargement en cours...</iframe>

```{r}
datatable(iris)
```

Dans le package `ggplot2`, vous trouvez plusieurs autres séries de données: 

```{r eval=FALSE}
str(midwest)
str(economics)
str(movies)
str(mpg)
str(msleep)
str(presidential)
str(seals)
```

Pour avoir plus de données, vous pouvez également consulter [Rdatasets](https://vincentarelbundock.github.io/Rdatasets/datasets.html).

# Syntaxes de base

## ggplot

```{r}
g<-ggplot(diamonds, aes(price, carat))+
  geom_point(color="firebrick")
g
```


## googleVis

```{r, results='asis'}
Bubble <- gvisBubbleChart(Fruits, idvar="Fruit", 
                          xvar="Sales", yvar="Expenses",
                          colorvar="Year", sizevar="Profit",
                          options=list(
                            hAxis='{minValue:75, maxValue:125}'))
plot(Bubble)
```

## ggvis

```{r}
mtcars %>% ggvis(~wt, ~mpg) %>% layer_points()
```


```{r resetOptions}
## Set options back to original options
options(op)
```

# Rédaction du mémo

- Choisissez une ou plusieurs de séries de données
- Choisissez la structure de votre mémo
- Le package que vous allez utiliser vous sera communiqué
- Construisez votre rapport rmarkdown
- Ce n'est pas fait dans les exemples, **mais vous devez commenter chaque graphique réalisé**.

**Approche fonctionnelle**

- [Comparaison](1_comparaison.html)
- [Relation](1_relation.html)
- [Composition](1_composition.html)
- [Histogramme](1_histogramme.html)

**Approche exploration des séries de données**

Si vous avez du temps restant, vous pouvez explorer une série de données en utilisant différents graphiques.

Posez-vous les bonnes questions pour comprendre le comportement des variables, comparer les variables entre elles, comparer les différentes catégories entre elles.


Exemples

- [Exploration et visualisation de la série de données mtcars](https://rstudio-pubs-static.s3.amazonaws.com/45786_b5e54c2d3c824f51abd2d559506cf81f.html)
- [Analyse des données avec iris](analyse_donnees_iris.html)

Pour ceux qui veulent aller plus loin: 

- [Couleurs des graphiques](http://www.stat.ubc.ca/~jenny/STAT545A/block14_colors.html)
- [Visualisation des données dans une table interactive](https://rstudio.github.io/DT/)
- [Visualisation des séries temporelles](tsplot.html)
- [Savoir mieux manipuler les données](http://zevross.com/blog/2015/01/13/a-new-data-processing-workflow-for-r-dplyr-magrittr-tidyr-ggplot2/)


```{r eval=FALSE, echo=FALSE}
# Here's an easy way to get all the URLs in R
start <- as.Date('2013-11-28')
today <- as.Date('2015-03-04')
 
all_days <- seq(start, today, by = 'day')
 
year <- as.POSIXlt(all_days)$year + 1900
urls <- paste0('http://cran-logs.rstudio.com/', year, '/', all_days, '.csv.gz')
urls

for (i in 1:length(urls)) {
  download.file(urls[i], sprintf("/temp%i.csv.gz", i))
}

```

